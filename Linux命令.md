# 实用指令



## 指定运行级别

**<u>0</u>** ：关机

**<u>1</u>** ：单用户【找回丢失密码】

**<u>2</u> **：多用户状态没有网络服务

**<u>3</u> **：多用户状态有网络服务

**<u>4</u> **：系统未使用保留给用户

**<u>5</u>** ：图形界面

**<u>6</u>** ：系统重启



## 编辑

### vi 和 vim 常用的三种模式

**正常模式**

​	可以使用【上下左右】来移动光标，可以【删除字符】或【删除整行】，也可以【复制、粘贴】来处理你的文件数据

**插入模式**

​	按下【i , I , o , O , a , A , r , R】等任意一个字符进入该模式

**命令行模式**

​	可以提供相关指令：完成读取、存盘、替换、离开 vi 或 vim 、显示行号等动作

```Linux
vi file
vim file
//当有该文件时打开并进入正常模式
//当该文件不存在时则会创建
```



### vi 和 vim 快捷键

<u>**部分命令需要在正常模式下输入**</u>

1. 拷贝当前行 **yy**（ **5yy** 拷贝当前行向下的5行）
2. 删除当前行 **dd**（ **5dd** 删除当前行向下的5行）
3. 查找文件中某个单词 【**命令行下 <u>/</u>关键字**，回车查找，输入 **n** 查找下一个】
4. 设置文件的行号和取消【**命令行下 <u>:set nu</u> 和 <u>:set nonu</u>**】
5. 文档最末行与最首行【最末行 **G** ，最首行 **gg** 】
6. 撤回【 **u** 】
7. 选择跳到该行【输入行号 20 ，在输入 <kbd>shift</kbd> + <kbd>g</kbd>】光标移动至20行



## 关机&重启命令

```Linux
shutdown -h now		//立刻进行关机
shudown -h 1		//"hello，1分钟后会关机了"
shutdown -r now		//现在重新启动计算机
halt				//关机，作用和上面一样
reboot				//现在重新启动计算机
sync				//把内存的数据同步到磁盘
/*
1、不管重启系统还是关闭系统，首先要执行 sync 命令，把内存中的数据写入磁盘中
2、目前 shutdown/reboot/halt 等命令都在关机前执行了 sync 。但还是建议手动保存一遍
*/
```



## 用户登录和注销

```Linux
su - username		//切换用户
logout		//注销用户
exit		//登出
/*
logout 在图形运行级别无效，在运行级别 3 下有效
*/
```



## 用户管理

### 添加用户

```Linux
useradd 用户名
useradd -d 指定目录 新的用户名	//指定目录
useradd -g 用户组 用户名		//将新增用户添加到一个组中
```



### 指定/修改密码

```Linux
passwd 用户名
```



### 当前用户所在目录

```Linux
pwd
```



### 删除用户

```Linux
userdel 用户名		//删除用户但保留家目录
userdel -r 用户名	//删除用户以及主目录
```



### 查询用户信息指令

```Linux
id 用户名
```



### 查看当前用户/登录用户

```Linux
whoami/who am I
```



## 用户组

### 新增组

```Linux
groupadd 组名
```



### 删除组

```Linux
groupdel 组名
```



### 修改用户的组

```Linux
usermod -g 用户组 用户名
```





## 用户和组相关文件

### /etc/passwd

每行的含义：**用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录shell**

### /etc/shadow

每行的含义：**登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志**

### /etc/group

每行的含义：**组名:口令:组标识号:组内用户列表**



## 帮助指令

### man 获得帮助信息

```Linux
man [命令或配置文件]		//获得帮助信息
```



### help 指令

```Linux
help 命令		//获得shell内置命令的帮助信息
```



## 文件目录类

### pwd 指令

```Linux
pwd			//显示当前工作目录的绝对路径
```



### ls 指令

```Linux
ls [选项] [目录或是文件]
```



### cd 指令

```Linux
cd [参数]			//切换到指定目录

/*
cd ~ 或者 cd :	//回到自己的家目录
cd ..			//回到当前目录的上一级目录
*/
```



### mkdir 指令

```Linux
mkdir [选项] 要创建的目录

/*
-p ：创建多级目录
*/
```



### rmdir 指令

```Linux
rmdir [选项] 要删除的空目录

/*
如果目录下有内容无法删除
删除非空目录，使用 rm -rf 要删除的目录 
*/
```



### touch 指令

```Linux
touch 文件名称		//创建空文件
```



### cp 指令

```Linux
cp [选项] source dest

/*
source ：拷贝的文件
dest ：指定路径
-r ：递归复制整个文件夹
强制覆盖不提示的方法：\cp
*/
```



### rm 指令

```Linux
rm [选项] 要删除的文件或目录

/*
-r ：递归删除整个文件夹
-f ：强制删除不提示
*/
```



### mv 指令

```Linux
mv oldNameFile newNameFile		//重命名
mv /temp/movefile /targetFolder	//移动文件
```



### cat 指令

```Linux
cat [选项] 要查看的文件			//查看文件

/*
-n ：显示行号
*/
```



### more 指令

```Linux
more 要查看的文件

/*
more 是一个基于 vi 编辑器的文本过滤器，它以全屏的方式按页显示文本文件的内容，
该指令中内置了若干快捷键（交互指令）详细操作如下
*/
```

| 操作     | 功能说明                              |
| -------- | ------------------------------------- |
| 空白键   | 代表向下翻一页                        |
| Enter    | 代表向下翻【一行】                    |
| q        | 代表立刻离开 more，不再显示该文件内容 |
| Ctrl + F | 向下滚动一屏                          |
| Ctrl + B | 返回上一屏                            |
| =[       | 输出当前行的行号                      |
| :f       | 输出文件名和当前行的行号              |



### less 指令

```Linux
less 要查看的文件

/*
用来分屏查看文件内容，它的功能与 more 指令类似，但更强大，支持各种显示终端。
该指令显示文件内容时，并不是一次将整个文件加载之后才显示，是根据显示需要加载内容，
对于显示大型文件具有较高的效率。
*/
```

| 操作       | 功能说明                                             |
| ---------- | ---------------------------------------------------- |
| 空白键     | 向下翻动一页                                         |
| [pagedown] | 向下翻动一页                                         |
| [pageup]   | 向上翻动一页                                         |
| /字串      | 向下搜寻【字串】的功能；n ：向下查找；N ：向上查找； |
| ？字串     | 向上搜寻【字串】的功能；n ：向上查找；N ：向下查找   |
| q          | 离开 less 这个程序                                   |



### echo 指令

```Linux
echo [选项] [输出内容]		//输出内容到控制台
```



### head 指令

```Linux
head 文件			//查看文件头10行内容
head -n 5 文件		//查看文件头5行内容，5可以是任意行数

/*
head用于显示文件的开头部分内容，默认情况下head指令显示文件的前10行内容
*/
```



### tail 指令

```Linux
tail 文件				//查看文件尾10行内容
tail -n 5 文件		//查看文件尾5行内容，5可以是任意行数
tail -f 文件			//实时追踪该文件的所有更新

/*
tail 用于输出文件中尾部的内容，默认情况下 tail 指令显示文件的后10行内容
*/
```



### > 指令和 >> 指令

  ```Linux
  > 输出重定向
  >> 追加
  
  //例子：
  ls -l > 文件				//列表的内容写入文件中（覆盖写）
  ls -al >> 文件			//列表的内容追加到文件的末尾
  cat 文件1 > 文件2			//文件1的内容覆盖文件2
  echo "内容" >> 文件
  ```



### ln 指令 

```Linux
ln -s [原文件或目录] [软链接名]		//给原文件创建一个软链接

/*
软链接也称为符号链接，类似于 Windows 里的快捷方式，主要存放了链接其他文件的路径。
当使用 pwd 指令查看目录时，仍然看到的是软链接所在目录
删除使用 rm 指令就好了
*/
```



### history 指令

```Linux
history			//查看已经执行过历史命令
history 10		//显示最近使用过的10个指令
!5				//执行历史编号为5的指令

/*
查看已经执行过历史命令，也可以执行历史命令
*/
```





## 时间日期类

### data 指令-显示当前日期

```Linux
date			//显示当前时间
date + %Y		//显示当前年份
date + %m		//显示当前月份
date + %d		//显示当前是哪一天
date "+%Y-%m-%d %H:%M:%S"		//显示年月日时分秒
```



### data 指令-设置日期

```Linux
date -s 字符串时间

//例子：
date -s "2021-12-13 20:53:53"
```



### cal 指令

```Linux
cal [选项]		//不加选项，显示本月日历

//例子：
cal 2020		//显示2020年日历
```





## 搜索查找类

### find 指令

```Linux
find [搜索范围] [选项]

//例子：
find /home -name hello.txt		//按文件按名查询
find /opt -user root			//按用户名查询
find / -size +200M		//查找 / 下查找大于200M的文件（+n大于 -n小于 n等于）
//单位除了 M 还有 k，M，G

/*
将从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示再终端
*/
```

| 选项            | 功能                             |
| --------------- | -------------------------------- |
| -name<查询方式> | 按照指定的文件名查找模式查找文件 |
| -user<用户名>   | 查找属于指定用户名所有文件       |
| -size<文件大小> | 按照指定的文件大小查找文件       |



### locate 指令

```Linux
locate 搜索文件

//例子：
updatedb
locate hello.txt

/*
locate 指令可以快速定位文件路径。locate指令利用事先建立的系统中所有文件名称及路径
的locate数据库实现快速定位给定的文件。locate 指令无需遍历整个文件系统，查询速度较快。
为了保证查询结果的准确度，管理员必须定期更新 locate 时刻

 注意：
由于 locate 指令基于数据库进行查询，所以第一次运行前，必须使用 updatedb 指令创建
locate数据库
*/
```



### which指令

```Linux
which 命令

/*
可以查看某个指令在哪个目录下，比如 ls 指令在哪个目录
*/
```



### grep指令和管道符号

```Linux
grep [选项] 查找内容 源文件
命令 | 命令		//管道符号：表示将前一个命令的处理结果输出传递给后面的命令处理

//例子：
grep -n "yes" /home/hello.txt		//在hello.txt文件中，查找 "yes" 所在行
cat /home/hello.txt | grep "yes"	//在hello.txt文件中，查找 "yes" 所在行

/*
grep 过滤查找
grep 命令是一种强大的文本搜索工具
*/
```



| 选项 | 功能             |
| ---- | ---------------- |
| -n   | 显示匹配行及行号 |
| -i   | 忽略字母大小写   |



## 压缩和解压类

### gzip/gunzip 指令

```Linux
gzip 文件			//压缩文件，只能将文件压缩为*.gz文件
gunzip 文件.gz	//解压缩文件命令
```

 

### zip/unzip 指令

```Linux
zip [选项] XXX.zip 将要压缩的内容	//压缩文件和目录的命令
unzip [选项] XXX.zip				//解压缩文件

/*
zip常用选项
-r ：递归压缩，即压缩目录

unzip
-d <目录> ：指定解压后文件的存放目录
*/
```



### tar 指令

```Linux
tar [选项] XXX.tar.gz 打包的内容		//打包目录，压缩后的文件格式.tar.gz

//例子：
tar -zcvf pc.tar.gz /home/pig.txt /home/cat.txt		//将两个文件打包压缩
tar -zcvf myhome.tar.gz /home/			//打包压缩 home 目录下的所有文件
tar -zxvf pc.tar.gz						//解压
tar -zxvf /home/myhome.tar.gz -C /opt/tmp2			//解压到指定目录

/*
tar 指令 是打包指令，最后打包后的文件是 .tar.gz 的文件
*/
```

| 选项 | 功能               |
| ---- | ------------------ |
| -c   | 产生 .tar 打包文件 |
| -v   | 显示详细信息       |
| -f   | 指定压缩后的文件名 |
| -z   | 打包同时压缩       |
| -x   | 解包 .tar 文件     |

 

## 组

1. 所有者
2. 所在组
3. 其它组
4. 改变用户所在的组



### 查看与修改文件的所有者

```Linux
ls -ahl			//查看文件的所有者
chown 用户名 文件名		//修改文件的所有者
chown newowner 文件/目录 	//改变所有者
chown newowner:newgroup 文件/目录 	//改变所有者和所在组
chgrp newgroup 文件/目录		//改变所在组
-R 如果是目录 则使其下所有子文件或目录递归生效
```



### 修改文件所在的组

```Linux
chgrp 组名 文件名
```



### 修改用户所在的组

```Linux
usermod -g 组名 用户名
usermod -d 目录名 用户名 改变该用户登录的初始目录
```



### 权限

```Linux
-rwxrw-r--

/*
1. 第0位确认文件类型（d,-,l,c,b）
	l 是链接，相当于windows的快捷方式
	d 是目录，相当于windows的文件夹
	c 是字符设备文件，鼠标，键盘
	b 是块设备，比如硬盘
2. 第1-3位确定所有者（该文件的所有者）拥有该文件的权限。---User
3. 第4-6位确定所属者（同用户组的）拥有该文件的权限，---Group
4. 第7-9位确定其他用户拥有该文件的权限 ---Other

[r]：可读，ls查看目录内容
[w]：可写，对目录内创建+删除+重命名目录
[x]：可执行，可以进入该目录
*/
```

 

### 修改权限

```Linux
chmod

/*
u：所有者 g：所有组 o：所有人 a：所有人（u、g、o的总和）
chmod u=rwx,g=rx,o=x 文件/目录名		//赋予权限
chmod o+w 文件/目录名				//添加权限
chmod a-x 文件/目录名				//删除权限
chmod 751						//r=4，w=2，x=1
*/
```



## crond 任务调度

任务调度：是指系统在某个时间执行的特定的命令或程序。



### crond 使用

```Linux
crontab [选项]

/*
-e：编辑 crontab 定时任务
-l：查询 crontab 任务
-r：删除当前用户所有的 crontab 任务
*/

//例子：
crontab -e
//回车后会进入 vi 编辑如下
*/1 * * * * ls -l /etc/ > /tmp/to.txt	//每分钟往to.txt中重定向 ls -l

conrtab -r		//终止任务调度
conrtab -l		//列出当前有那些任务调度
service crond restart		//重启任务调度
```

| 项目       | 含义                 | 范围                    |
| ---------- | -------------------- | :---------------------- |
| 第一个 "*" | 一小时当中的第几分钟 | 0-59                    |
| 第二个 "*" | 一天当中的第几小时   | 0-23                    |
| 第三个 "*" | 一个月当中的第几天   | 1-31                    |
| 第四个 "*" | 一年当中的第几月     | 1-12                    |
| 第五个 "*" | 一周当中的星期几     | 0-7（0和7都代表星期日） |

| 特殊符号 | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| *        | 代表任何时间，比如第一个 "*" 就代表一小时中每分钟都执行一次的意思 |
| ，       | 代表不连续的时间。比如 ”0，8，12，16 * * * “，就代表在每天的8点，12点，16点都执行一次命令 |
| -        | 代表连续的时间范围。比如 “0 5 * * 1-6 ”，代表在周一到周六的凌晨5点执行命令 |
| */n      | 代表每隔多久执行一次。“*/10 * * * * ”，代表每隔10分钟就执行一遍命令 |

